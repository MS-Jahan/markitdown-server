# ========================================
# MarkItDown Server - Environment Variables
# ========================================
# Copy this file to .env and customize values for your deployment
# For Coolify: Add these variables in the Environment Variables section

# ===== Application Configuration =====

# Maximum file upload size in MB (default: 50)
# Increase for larger PDFs, but watch memory usage
MAX_FILE_SIZE_MB=50

# Request timeout in seconds (default: 120)
# This is informational; actual timeout is controlled by GUNICORN_TIMEOUT
REQUEST_TIMEOUT_SECONDS=120

# Enable MarkItDown third-party plugins (default: false)
# Set to 'true' to enable community plugins
# See: https://github.com/microsoft/markitdown#plugins
ENABLE_MARKITDOWN_PLUGINS=false

# ===== Logging Configuration =====

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL (default: INFO)
# Use DEBUG for troubleshooting, INFO for production
LOG_LEVEL=INFO

# ===== Gunicorn Worker Configuration =====

# Number of worker processes (default: CPU cores * 2 + 1)
# Increase for higher concurrency, decrease to save memory
# Recommended: 4-8 for most deployments
GUNICORN_WORKERS=4

# Worker timeout in seconds (default: 120)
# Increase if processing very large files
# Must be >= REQUEST_TIMEOUT_SECONDS
GUNICORN_TIMEOUT=120

# Graceful timeout for worker shutdown in seconds (default: 30)
GUNICORN_GRACEFUL_TIMEOUT=30

# Maximum requests per worker before restart (default: 1000)
# Helps prevent memory leaks by recycling workers
# Lower value = more frequent restarts = safer but slightly slower
GUNICORN_MAX_REQUESTS=1000

# Jitter for max requests (default: 50)
# Prevents all workers from restarting simultaneously
GUNICORN_MAX_REQUESTS_JITTER=50

# ===== Docker Resource Limits =====

# Memory limit for the container (default: 2G)
# Increase if processing very large files or many concurrent requests
# Format: 512M, 1G, 2G, 4G, etc.
DOCKER_MEMORY_LIMIT=2G

# CPU limit for the container (default: 2.0)
# 1.0 = 1 full CPU core, 2.0 = 2 cores
DOCKER_CPU_LIMIT=2.0

# Memory reservation (guaranteed memory, default: 512M)
DOCKER_MEMORY_RESERVATION=512M

# CPU reservation (guaranteed CPU, default: 0.5)
DOCKER_CPU_RESERVATION=0.5

# ===== Optional: LLM Integration =====
# For AI-powered image descriptions in PDFs and PowerPoint files
# Leave empty to disable

# OpenAI model to use (e.g., gpt-4o, gpt-4-vision-preview, gpt-4o-mini)
# Only used for generating descriptions of images in documents
LLM_MODEL=

# OpenAI API key (required if LLM_MODEL is set)
# Get your key from: https://platform.openai.com/api-keys
LLM_API_KEY=

# ===== Notes for Coolify Deployment =====
# 1. Add each variable in Coolify's Environment Variables section
# 2. Sensitive variables (LLM_API_KEY) should be marked as "Secret"
# 3. After changing variables, restart the service for changes to take effect
# 4. Monitor memory usage and adjust DOCKER_MEMORY_LIMIT if needed
# 5. For high-traffic sites, increase GUNICORN_WORKERS
